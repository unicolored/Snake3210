function snakeloop(){snakegame.over===!1&&(snakegame.resetCanvas(),snakegame.drawScore(),snakeserpent.move(),snakefood.draw(),snakeserpent.draw(),snakegame.drawMessage(),snakegame.distance++),setTimeout(function(){requestAnimationFrame(snakeloop)},1e3/snakegame.fps),setTimeout(function(){snakegame.timer++},1e3)}function updatetheScore(){var a=Number($("#scoreInput").val()),b=Number($("#distanceInput").val()),c=Number($("#timerInput").val()),d=$("#nameInput").val();if(0!==d.length&&0!==a){$("#scoreInput").val(0),$("#distanceInput").val(0),$("#timerInput").val(0),$("#vitesseInput").val(0),$(".entername .btn-success").prop("disabled",!0),$(".entername .leaderboard-score").hide(),$(".entername .leaderboard-distance").hide(),$(".entername .text-info").hide();var e=scoreListRef.push();e.setWithPriority({name:d,score:a,distance:b,timer:c,timestamp:Firebase.ServerValue.TIMESTAMP},a)}}var snakecanvas=document.getElementById("the-game"),snakecontext=snakecanvas.getContext("2d");snakegame={score:0,fps:8,over:!1,message:null,distance:1,timer:0,start:function(){snakegame.over=!1,snakegame.message=null,snakegame.score=0,snakegame.fps=8,snakeserpent.init(),snakefood.set(),snakegame.distance=1,snakegame.timer=0,onStart()},stop:function(){snakegame.over=!0,snakegame.message="START",$(".soumettre").show(),$(".entername .btn-success").prop("disabled",!1);var a=new Firebase("https://snakeleader.firebaseio.com/snakeGlobal/distanceTotale");a.transaction(function(a){return a+Math.round(.02*snakegame.distance*snakegame.fps)})},drawBox:function(a,b,c,d){snakecontext.fillStyle=d,snakecontext.beginPath(),snakecontext.moveTo(a-c/2,b-c/2),snakecontext.lineTo(a+c/2,b-c/2),snakecontext.lineTo(a+c/2,b+c/2),snakecontext.lineTo(a-c/2,b+c/2),snakecontext.closePath(),snakecontext.fill()},drawScore:function(){$(".leaderboard-score").val(100*snakegame.score),$(".timer").val(Math.round(snakegame.timer/10)),$(".vitesse").val(Math.round(snakegame.fps)),$(".leaderboard-distance").val(Math.round(.02*snakegame.distance*snakegame.fps))},drawMessage:function(){null!==snakegame.message&&(snakecontext.fillStyle="#eee",snakecontext.strokeStyle="#000",snakecontext.font=snakecanvas.height/4+"px VT323",snakecontext.textAlign="center",snakecontext.fillText(snakegame.message,snakecanvas.width/2,snakecanvas.height/2),snakecontext.strokeText(snakegame.message,snakecanvas.width/2,snakecanvas.height/2))},resetCanvas:function(){snakecontext.clearRect(0,0,snakecanvas.width,snakecanvas.height)}},snakeserpent={size:snakecanvas.width/40,x:null,y:null,color:"#e23134",direction:"left",sections:[],init:function(){for(snakeserpent.sections=[],snakeserpent.direction="left",snakeserpent.x=snakecanvas.width/2+snakeserpent.size/2,snakeserpent.y=snakecanvas.height/2+snakeserpent.size/2,i=snakeserpent.x+5*snakeserpent.size;i>=snakeserpent.x;i-=snakeserpent.size)snakeserpent.sections.push(i+","+snakeserpent.y)},move:function(){switch(snakeserpent.direction){case"up":snakeserpent.y-=snakeserpent.size;break;case"down":snakeserpent.y+=snakeserpent.size;break;case"left":snakeserpent.x-=snakeserpent.size;break;case"right":snakeserpent.x+=snakeserpent.size}snakeserpent.checkCollision(),snakeserpent.checkGrowth(),snakeserpent.sections.push(snakeserpent.x+","+snakeserpent.y)},draw:function(){for(i=0;i<snakeserpent.sections.length;i++)snakeserpent.drawSection(snakeserpent.sections[i].split(","))},drawSection:function(a){snakegame.drawBox(parseInt(a[0]),parseInt(a[1]),snakeserpent.size,snakeserpent.color)},checkCollision:function(){snakeserpent.isCollision(snakeserpent.x,snakeserpent.y)===!0&&snakegame.stop()},isCollision:function(a,b){return a<snakeserpent.size/2||a>snakecanvas.width||b<snakeserpent.size/2||b>snakecanvas.height||snakeserpent.sections.indexOf(a+","+b)>=0?!0:void 0},checkGrowth:function(){snakeserpent.x==snakefood.x&&snakeserpent.y==snakefood.y?(snakegame.score++,snakegame.score%5===0&&snakegame.fps<60&&snakegame.fps++,snakefood.set(),snakefood.set()):snakeserpent.sections.shift()}},snakefood={size:null,x:null,y:null,color:"#eee",set:function(){snakefood.size=snakeserpent.size,snakefood.x=Math.ceil(10*Math.random())*snakeserpent.size*4-snakeserpent.size/2,snakefood.y=Math.ceil(10*Math.random())*snakeserpent.size*3-snakeserpent.size/2},draw:function(){snakegame.drawBox(snakefood.x,snakefood.y,snakefood.size,snakefood.color)}},inverseDirection={up:"down",left:"right",right:"left",down:"up"};var kbd=[];kbd[38]="up",kbd[104]="up",kbd[39]="right",kbd[102]="right",kbd[40]="down",kbd[98]="down",kbd[37]="left",kbd[100]="left",addEventListener("keydown",function(a){lastKey=kbd[a.which],["up","down","left","right"].indexOf(lastKey)>=0&&lastKey!=inverseDirection[snakeserpent.direction]?snakeserpent.direction=lastKey:["start_snakegame"].indexOf(lastKey)>=0&&snakegame.over&&snakegame.start()},!1);var requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;requestAnimationFrame(snakeloop),$("canvas#the-game").click(function(){snakegame.start()});